<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Fantastic DSLs</title>
    <meta name="description" content="replace this description">
    <meta name="author" content="put your name here">
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
    <!-- Base styles -->
    <link rel="stylesheet" href="components/reveal.js/css/reveal.css">
    <link rel="stylesheet" href="css/build/theme.css" id="theme">
    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="components/reveal.js/lib/css/zenburn.css">
    <!-- Printing and PDF exports -->
    <script type="text/javascript">
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ?
            'components/reveal.js/css/print/pdf.css' :
            'components/reveal.js/css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>
    <!--[if lt IE 9]>
    <script src="components/reveal.js/lib/js/html5shiv.js"></script>
    <![endif]-->
    <style>
        td {
            padding: 0 !important;
        }

        code {
            width: 100%;
            max-height: 600px !important;
        }
    </style>
</head>
<body>
<div class="reveal">
    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">
        <section data-background-image="img/1.jpg">
            <div style="font-size: 110px; font-family: Harry P, fantasy">
                <p>Fantastic<p>
                <p style="font-size: 180px">DSLs<p>
                <p>and where to find them</p>
            </div>
        </section>

        <section>
            <style>
                img {
                    background: none !important;
                    border: 0 !important;
                }
            </style>
            <img src="img/canva.png" height="280px">
            <p style="text-align: left; margin-left: 100px">
                <br><a href="http://serce.me">http://serce.me</a>
                <br><a href="http://github.com/SerCeMan">GitHub @SerCeMan</a>
                <br><a href="http://twitter.com/SerCeMan">Twitter @SerCeMan</a>
                <br>
                <img style="margin-left: -30px;" src="img/jetbrains.svg" height="140px">
                <img src="img/kotlin.png" height="140px">
            </p>
        </section>

        <section>
            <h2>Extension functions</h2>
            <table width="100%">
                <tr>
                    <td>
                        <pre style="padding-bottom: 30px"><code data-trim class="kotlin hljs">
@@include('ext1/f1.kt')
                        </code></pre>
                        <pre><code class="kotlin hljs" data-trim>
@@include('ext1/f2.kt')
                        </code></pre>
                    </td>
                    <td class="code">
                        <pre><code class="java hljs" data-trim>
@@include('ext1/f3.jv')
                        </code></pre>
                    </td>
                </tr>
            </table>

        </section>


        <section>
            <h2>Extension functions</h2>
            <table width="100%">
                <tr>
                    <td>
                        <pre><code style="overflow: hidden; width: 100%" class="kotlin hljs" data-trim>
@@include('ext2/f1.kts')
                        </code></pre>
                    </td>
                    <td class="code">
                        <pre><code style="overflow: hidden; width: 100%" class="java hljs" data-trim>
@@include('ext2/f2.jv')
                        </code></pre>
                    </td>
                </tr>
            </table>

        </section>


        <section style="padding: 0">
            <h2>Extension functions</h2>
            <table width="100%">
                <tr>
                    <td>
                        <pre><code class="kotlin hljs" data-trim>
@@include('ext3/f1.kts')
                        </code></pre>
                    </td>
                    <td class="code">
                        <pre><code class="java hljs" data-trim>
@@include('ext3/f2.jv')
                        </code></pre>
                    </td>
                </tr>
            </table>

        </section>

        <section>
            <h2>HTML</h2>
            <pre><code style="overflow: hidden; width: 100%" class="kotlin hljs" data-trim>
@@include('html/f1.kts')
</code></pre>
            <a href="https://github.com/TinyMission/kara">github.com/TinyMission/kara</a>
        </section>


        <section>
            <h2>IDE</h2>
        </section>


        <section>
            <h2>Teamcity DSL</h2>
            <pre><code style="overflow: hidden; width: 100%" class="kotlin hljs" data-trim>
object Project : Project({
  uuid = "my_project_id"
  extId = "ExampleOfDSL"
  name = "Example of DSL"

  val vcsRoot = GitVcsRoot({
    uuid = "my_vcs_root_id"
    name = "Example of DSL VCS Root"
    url = "..."
  })
  buildType {
    uuid = "my_build_type_id"
    extId = "ExampleOfDSL_Build"
    name = "Build"
    buildNumberPattern = "%build.counter%"
    vcs {
      root(vcsRoot)
    }
    steps {
      maven {
        goals = "clean test"
      }
    }
  }
})
</code></pre>
            <a href="https://blog.jetbrains.com/teamcity/2016/11/kotlin-configuration-scripts-an-introduction/">blog.jetbrains.com/teamcity/2016/11/kotlin-configuration-scripts-an-introduction/</a>
        </section>


        <section>
            <h2>Gradle Kotlin</h2>
            <pre><code style="overflow: hidden; width: 100%" class="kotlin hljs" data-trim>
apply {
    plugin("com.android.application")
    plugin("kotlin-android")
}

android {
    buildToolsVersion("25.0.0")
    compileSdkVersion(23)

    defaultConfig {
        minSdkVersion(15)

        applicationId = "com.example.kotlingradle"
    }

    buildTypes {
        getByName("release") {
            isMinifyEnabled = false
        }
    }
}

dependencies {
    compile("com.android.support:appcompat-v7:23.4.0")
    compile(kotlinModule("stdlib"))
}
</code></pre>
            <a href="https://github.com/gradle/gradle-script-kotlin">github.com/gradle/gradle-script-kotlin</a>
        </section>


        <section>
            <h2>Anko</h2>
            <pre><code style="overflow: hidden; width: 100%" class="kotlin hljs" data-trim>
override fun onCreate(savedInstanceState: Bundle?) {
    super.onCreate(savedInstanceState)

    verticalLayout {
        padding = dip(30)
        editText {
            hint = "Name"
            textSize = 24f
        }
        editText {
            hint = "Password"
            textSize = 24f
        }
        button("Login") {
            textSize = 26f
        }
    }
}
            </code></pre>
            <a href="https://github.com/Kotlin/anko">github.com/Kotlin/anko</a>
        </section>


        <section>
            <h2>Spek</h2>
            <pre><code style="overflow: hidden; width: 100%" class="kotlin hljs" data-trim>
object SimpleSpec: Spek({
    describe("a calculator") {
        val calculator = SampleCalculator()

        on("addition") {
            val sum = calculator.sum(2, 4)

            it("should return the result of adding") {
                assertEquals(6, sum)
            }
        }

        on("subtraction") {
            val subtract = calculator.subtract(4, 2)

            it("should return the result of subtracting") {
                assertEquals(2, subtract)
            }
        }
    }
})
            </code></pre>
            <a href="http://spekframework.org">spekframework.org</a>
        </section>


        <section>
            <h2>Domain</h2>
            <img style="border: 0 !important;" width="600px" src="img/domain.svg">
        </section>


        <section>
            <h2>Data classes</h2>
            <table width="100%">
                <tr>
                    <td>
                        <pre style="padding-bottom: 30px"><code data-trim class="kotlin hljs">
@@include('domain/data1.kt')
                        </code></pre>
                        <pre><code class="kotlin hljs" data-trim>
@@include('domain/data2.kt')
                        </code></pre>
                    </td>
                    <td class="code">
                        <pre><code class="kotlin hljs" data-trim>
@@include('domain/data3.kt')
                        </code></pre>
                        <pre><code class="kotlin hljs" data-trim>
@@include('domain/data4.kt')
                        </code></pre>
                    </td>
                </tr>
            </table>
        </section>


        <section>
            <h2>Persistent data structures</h2>
            <pre><code style="overflow: hidden; width: 100%" class="java hljs" data-trim>
            </code></pre>
        </section>


        <section>
            <h2>Persistent DS</h2>
            <table width="100%">
                <tr>
                    <td>
                        <pre style="padding-bottom: 30px"><code data-trim class="kotlin hljs">
@@include('domain/clj1.kt')
                        </code></pre>
                    </td>
                    <td class="code">
                        <pre><code class="kotlin hljs" data-trim>
@@include('domain/clj2.kt')
                        </code></pre>
                    </td>
                </tr>
            </table>
        </section>



        <section>
            <h2>Extension function on generic types</h2>
            <pre><code style="overflow: hidden; width: 100%" class="kotlin hljs" data-trim>
fun Collection&lt;Int&gt;.toIntArray(): IntArray {
  val result = IntArray(size)
  var index = 0
  for (element in this)
    result[index++] = element
  return result
}
            </code></pre>
        </section>


        <section data-background-image="img/niffler.jpg">
            <h2>Delegates</h2>
            <table width="100%">
                <tr>
                    <td>
                        <pre><code style="overflow: hidden; width: 100%" class="kotlin hljs" data-trim>
@@include('del/f1.kts')
                        </code></pre>
                    </td>
                    <td class="code">
                        <pre><code style="overflow: hidden; width: 100%" class="java hljs" data-trim>
@@include('del/f2.jv')
                        </code></pre>
                    </td>
                </tr>
            </table>
        </section>


        <section>
            <h2>IDE</h2>
        </section>


        <section>
            <h2>Conclusion</h2>
            <ul>
                <li>DSLs in Kotlin are easy to build</li>
                <li>DSLs in Kotlin work ideally as configuration API</li>
                <li>They can work as a powerful abstraction</li>
            </ul>
        </section>

        <section>
            <h2>Warning</h2>
            Don't use it for evil
            <pre><code style="overflow: hidden; width: 100%" class="kotlin hljs" data-trim>
class Ternary&lt;T&gt;(val expr: Boolean, val then: T) {
  operator fun div(elsе: T): T = if (expr) then else elsе
}

operator fun &lt;T&gt; Boolean.rem(a: T): Ternary&lt;T&gt; = Ternary(this, a)

val result = (5 == 2 + 3) % 1 / 2 // 1
            </code></pre>
            <a href="https://gist.github.com/naixx/9d94c1498c4d45ffda3a">gist.github.com/naixx/9d94c1498c4d45ffda3a</a>
        </section>

        <section>
            <h2>Thank you</h2>

            <p>Some resources:</p>
            <ul>
                <li>
                    <a href="https://victor.kropp.name/blog/kotlin-dsls-good-bad-and-ugly/">DSLs in Kotlin: The Good, the Bad and the Ugly</a>
                </li>
                <li>
                    <a href="http://jonnyzzz.com/blog/2016/09/02/dsl-building/">Building DSL Instead of an IDE Plugin</a>
                </li>
            </ul>
        </section>


    </div>

</div>

<script type="text/javascript" src="components/reveal.js/lib/js/head.min.js"></script>
<script type="text/javascript" src="components/reveal.js/js/reveal.js"></script>
<script type="text/javascript" src="js/index.js"></script>

</body>
</html>
